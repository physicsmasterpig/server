<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard - BrainDB</title>
    <style>
        /* Analytics Page Styles */
        .analytics-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        /* Stats Overview */
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }
        
        .stat-card {
            background-color: #13161B;
            border: 1px solid #22262F;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .stat-label {
            font-size: 14px;
            color: #94979C;
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 5px;
        }
        
        .stat-change {
            font-size: 12px;
            color: #4CAF50;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .stat-change.negative {
            color: #F44336;
        }
        
        /* Analysis Controls */
        .analysis-controls {
            background-color: #13161B;
            border: 1px solid #22262F;
            border-radius: 10px;
            padding: 20px;
        }
        
        .analysis-tabs {
            display: flex;
            gap: 24px;
            margin-bottom: 16px;
        }
        
        .analysis-scope {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
        }
        
        .scope-label {
            font-size: 14px;
            font-weight: 600;
            color: #FFFFFF;
        }
        
        .scope-selector {
            display: flex;
            background-color: #0C0E12;
            border-radius: 8px;
            overflow: hidden;
            padding: 4px;
            width: 100%;
        }
        
        .scope-option {
            flex: 1;
            text-align: center;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 6px;
            color: #94979C;
        }
        
        .scope-option:hover {
            color: #FFFFFF;
        }
        
        .scope-option.active {
            background-color: #7F56D9;
            color: #FFFFFF;
        }
        
        /* Filter Controls */
        .filter-section {
            padding: 20px 0;
        }
        
        .filter-title {
            font-size: 14px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 16px;
        }
        
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 16px;
        }
        
        .filter-column {
            flex: 1;
            min-width: 200px;
        }
        
        .filter-label {
            display: block;
            font-size: 12px;
            color: #94979C;
            margin-bottom: 6px;
        }
        
        .filter-select, .filter-input {
            width: 100%;
            background-color: #0C0E12;
            border: 1px solid #22262F;
            border-radius: 6px;
            padding: 10px 12px;
            color: #FFFFFF;
            font-size: 14px;
        }
        
        .filter-select option {
            background-color: #13161B;
            color: #FFFFFF;
        }
        
        .filter-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .apply-filters-btn {
            background-color: #7F56D9;
            color: #FFFFFF;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .apply-filters-btn:hover {
            background-color: #6941C6;
            transform: translateY(-2px);
        }
        
        .multi-select-container {
            background-color: #0C0E12;
            border: 1px solid #22262F;
            border-radius: 6px;
            padding: 8px;
            max-height: 150px;
            overflow-y: auto;
        }
        
        .multi-select-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px;
            border-radius: 4px;
        }
        
        .multi-select-item:hover {
            background-color: #1A1E26;
        }
        
        .multi-select-item input[type="checkbox"] {
            accent-color: #7F56D9;
        }
        
        .multi-select-item label {
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }
        
        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 8px;
        }
        
        .toggle-input {
            display: none;
        }
        
        .toggle-label {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 24px;
            background-color: #22262F;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .toggle-label:after {
            content: '';
            position: absolute;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background-color: #FFFFFF;
            top: 3px;
            left: 3px;
            transition: all 0.3s ease;
        }
        
        .toggle-input:checked + .toggle-label {
            background-color: #7F56D9;
        }
        
        .toggle-input:checked + .toggle-label:after {
            left: 27px;
        }
        
        .toggle-text {
            color: #94979C;
            font-size: 14px;
        }
        
        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            gap: 12px;
            border-bottom: 1px solid #22262F;
            margin-bottom: 24px;
        }
        
        .tab-item {
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 600;
            color: #94979C;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab-item:hover {
            color: #FFFFFF;
        }
        
        .tab-item.active {
            color: #7F56D9;
            border-bottom-color: #7F56D9;
        }
        
        /* Tab Content */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Chart Layout */
        .chart-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .chart-container {
            background-color: #13161B;
            border: 1px solid #22262F;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .chart-header {
            padding: 16px;
            border-bottom: 1px solid #22262F;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
        }
        
        .chart-subtitle {
            font-size: 12px;
            color: #94979C;
            margin-top: 4px;
        }
        
        .chart-actions {
            display: flex;
            gap: 8px;
        }
        
        .chart-action-btn {
            background-color: transparent;
            border: none;
            color: #94979C;
            cursor: pointer;
            font-size: 14px;
        }
        
        .chart-body {
            padding: 20px;
            height: 300px;
            position: relative;
        }
        
        .chart-footer {
            padding: 12px 16px;
            border-top: 1px solid #22262F;
            font-size: 12px;
            color: #94979C;
            text-align: center;
        }
        
        .full-width-chart {
            grid-column: 1 / -1;
        }
        
        /* Data Table */
        .data-table-container {
            background-color: #13161B;
            border: 1px solid #22262F;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 24px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th {
            background-color: #0C0E12;
            color: #94979C;
            text-align: left;
            padding: 12px 16px;
            font-size: 12px;
            font-weight: normal;
            border-bottom: 1px solid #22262F;
        }
        
        .data-table td {
            padding: 12px 16px;
            font-size: 14px;
            color: #FFFFFF;
            border-bottom: 1px solid #22262F;
        }
        
        .data-table tr:last-child td {
            border-bottom: none;
        }
        
        .data-table tr:hover td {
            background-color: #1A1E26;
        }
        
        /* Loading indicator */
        .analytics-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .analytics-loading-content {
            background-color: #13161B;
            border: 1px solid #22262F;
            border-radius: 10px;
            padding: 20px 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }
        
        .analytics-loading-text {
            color: #FFFFFF;
            font-size: 16px;
        }
        
        .analytics-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(127, 86, 217, 0.2);
            border-left-color: #7F56D9;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Comparison Section */
        .comparison-container {
            padding: 20px;
            background-color: #13161B;
            border: 1px solid #22262F;
            border-radius: 10px;
            margin-bottom: 24px;
        }
        
        .comparison-header {
            margin-bottom: 16px;
        }
        
        .comparison-title {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 8px;
        }
        
        .comparison-description {
            font-size: 14px;
            color: #94979C;
        }
        
        .comparison-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .comparison-option {
            flex: 1;
            min-width: 200px;
        }
        
        .comparison-items {
            background-color: #0C0E12;
            border: 1px solid #22262F;
            border-radius: 6px;
            padding: 10px;
            margin-top: 16px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .comparison-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: 4px;
        }
        
        .comparison-item:hover {
            background-color: #1A1E26;
        }
        
        .run-comparison-btn {
            background-color: #7F56D9;
            color: #FFFFFF;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 16px;
        }
        
        .run-comparison-btn:hover {
            background-color: #6941C6;
        }
    </style>
</head>
<body>
    <div class="analytics-container">
        <h1>Analytics Dashboard</h1>
        
        <!-- Loading indicator -->
        <div id="analytics-loading-indicator" class="analytics-loading">
            <div class="analytics-loading-content">
                <div class="analytics-spinner"></div>
                <div class="analytics-loading-text">Loading analytics data...</div>
            </div>
        </div>
        
        <!-- Stats Overview Section -->
        <div class="stats-overview">
            <div class="stat-card">
                <div class="stat-label">Total Students</div>
                <div class="stat-value" id="total-students-stat">0</div>
                <div class="stat-change">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 4L12 8L8 12M4 8L12 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span id="active-students">0 active</span>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Attendance Rate</div>
                <div class="stat-value" id="attendance-rate-stat">0%</div>
                <div class="stat-change">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 12L4 8L8 4M12 8L4 8" stroke="#4CAF50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>2.4% increase</span>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Avg. Exam Score</div>
                <div class="stat-value" id="avg-exam-score-stat">0%</div>
                <div class="stat-change negative">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 4L12 8L8 12M4 8L12 8" stroke="#F44336" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>1.2% decrease</span>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Homework Completion</div>
                <div class="stat-value" id="homework-completion-stat">0%</div>
                <div class="stat-change">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 12L4 8L8 4M12 8L4 8" stroke="#4CAF50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>3.7% increase</span>
                </div>
            </div>
        </div>
        
        <!-- Analysis Controls Section -->
        <div class="analysis-controls">
            <div class="filter-section">
                <div class="filter-title">Analysis Scope & Filters</div>
                <div class="filter-row">
                    <div class="filter-column">
                        <label class="filter-label" for="analysis-scope">Analysis Scope</label>
                        <select class="filter-select" id="analysis-scope">
                            <option value="all">All Data</option>
                            <option value="by-student">By Student</option>
                            <option value="by-class">By Class</option>
                            <option value="by-school">By School</option>
                        </select>
                    </div>
                    
                    <div class="filter-column">
                        <label class="filter-label" for="time-period">Time Period</label>
                        <select class="filter-select" id="time-period">
                            <option value="current">Current Semester (2025-1)</option>
                            <option value="previous">Previous Semester (2024-2)</option>
                            <option value="year">Last Year</option>
                            <option value="all-time">All Time</option>
                        </select>
                    </div>
                </div>
                
                <!-- Dynamic scope filters will be inserted here -->
                <div class="filter-row" id="scope-filter-container">
                    <p class="filter-label">No additional filters needed</p>
                </div>
                
                <div class="filter-actions">
                    <button id="apply-filters" class="apply-filters-btn">Apply Filters</button>
                </div>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <div class="tab-item active" data-tab="attendance">Attendance Analysis</div>
            <div class="tab-item" data-tab="performance">Performance Analysis</div>
            <div class="tab-item" data-tab="comments">Comment Analysis</div>
            <div class="tab-item" data-tab="comparison">Comparison</div>
        </div>
        
        <!-- Attendance Analysis Tab -->
        <div id="attendance-tab" class="tab-content active">
            <div class="chart-row">
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Attendance Patterns</div>
                            <div class="chart-subtitle">Weekly attendance trends</div>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="attendance-pattern-chart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Attendance by Day</div>
                            <div class="chart-subtitle">Attendance rate by day of week</div>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="attendance-by-day-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="chart-row">
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">Attendance Distribution</div>
                    </div>
                    <div class="chart-body">
                        <canvas id="attendance-distribution-chart"></canvas>
                    </div>
                </div>
                
                <div class="data-table-container">
                    <div class="chart-header">
                        <div class="chart-title">Attendance Summary</div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Count</th>
                                <th>Percentage</th>
                                <th>Change</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Present</td>
                                <td>358</td>
                                <td>78%</td>
                                <td class="stat-change">+2.4%</td>
                            </tr>
                            <tr>
                                <td>Absent</td>
                                <td>37</td>
                                <td>8%</td>
                                <td class="stat-change negative">+0.5%</td>
                            </tr>
                            <tr>
                                <td>Late</td>
                                <td>46</td>
                                <td>10%</td>
                                <td class="stat-change negative">+0.2%</td>
                            </tr>
                            <tr>
                                <td>Excused</td>
                                <td>18</td>
                                <td>4%</td>
                                <td class="stat-change">-3.1%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Performance Analysis Tab -->
        <div id="performance-tab" class="tab-content">
            <div class="chart-row">
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">Grade Distribution</div>
                    </div>
                    <div class="chart-body">
                        <canvas id="grade-distribution-chart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">Subject Performance</div>
                    </div>
                    <div class="chart-body">
                        <canvas id="subject-performance-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="chart-row">
                <div class="chart-container full-width-chart">
                    <div class="chart-header">
                        <div class="chart-title">Performance vs. Attendance</div>
                    </div>
                    <div class="chart-body">
                        <canvas id="performance-attendance-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="data-table-container">
                <div class="chart-header">
                    <div class="chart-title">Performance Summary</div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Subject</th>
                            <th>Average</th>
                            <th>Median</th>
                            <th>Standard Deviation</th>
                            <th>Pass Rate</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Mathematics</td>
                            <td>85%</td>
                            <td>87%</td>
                            <td>6.2</td>
                            <td>95%</td>
                        </tr>
                        <tr>
                            <td>Science</td>
                            <td>78%</td>
                            <td>80%</td>
                            <td>7.5</td>
                            <td>92%</td>
                        </tr>
                        <tr>
                            <td>English</td>
                            <td>82%</td>
                            <td>83%</td>
                            <td>5.8</td>
                            <td>97%</td>
                        </tr>
                        <tr>
                            <td>History</td>
                            <td>75%</td>
                            <td>76%</td>
                            <td>8.3</td>
                            <td>89%</td>
                        </tr>
                        <tr>
                            <td>Computer Science</td>
                            <td>88%</</td>
                            <td>90%</td>
                            <td>6.7</td>
                            <td>98%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Comment Analysis Tab -->
        <div id="comments-tab" class="tab-content">
            <div class="chart-row">
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">Comment Classification</div>
                    </div>
                    <div class="chart-body">
                        <canvas id="comment-classification-chart"></canvas>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">Common Keywords</div>
                    </div>
                    <div class="chart-body">
                        <canvas id="comment-keywords-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="data-table-container">
                <div class="chart-header">
                    <div class="chart-title">Sample Comments</div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Exam</th>
                            <th>Comment</th>
                            <th>Classification</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Mathematics Midterm</td>
                            <td>Excellent understanding of concepts. Great work!</td>
                            <td>Positive Feedback</td>
                            <td>95%</td>
                        </tr>
                        <tr>
                            <td>Science Quiz 2</td>
                            <td>Good performance. Shows strong grasp of material.</td>
                            <td>Positive Feedback</td>
                            <td>82%</td>
                        </tr>
                        <tr>
                            <td>English Essay</td>
                            <td>Satisfactory work, but could improve in certain areas.</td>
                            <td>Constructive Criticism</td>
                            <td>76%</td>
                        </tr>
                        <tr>
                            <td>History Final</td>
                            <td>Needs additional review and practice.</td>
                            <td>Needs Improvement</td>
                            <td>65%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Comparison Tab -->
        <div id="comparison-tab" class="tab-content">
            <div class="comparison-container">
                <div class="comparison-header">
                    <div class="comparison-title">Run Comparison Analysis</div>
                    <div class="comparison-description">Select items to compare and analysis metrics</div>
                </div>
                
                <div class="comparison-controls">
                    <div class="comparison-option">
                        <label class="filter-label" for="comparison-type">Comparison Type</label>
                        <select class="filter-select" id="comparison-type">
                            <option value="classes">Compare Classes</option>
                            <option value="students">Compare Students</option>
                            <option value="schools">Compare Schools</option>
                            <option value="periods">Compare Time Periods</option>
                        </select>
                    </div>
                    
                    <div class="comparison-option">
                        <label class="filter-label" for="comparison-metric">Comparison Metric</label>
                        <select class="filter-select" id="comparison-metric">
                            <option value="attendance">Attendance</option>
                            <option value="exam-scores">Exam Scores</option>
                            <option value="homework">Homework Completion</option>
                            <option value="improvement">Improvement Rate</option>
                        </select>
                    </div>
                </div>
                
                <div class="comparison-option">
                    <label class="filter-label">Select Items to Compare</label>
                    <div class="comparison-items" id="comparison-items">
                        <div class="comparison-item">
                            <input type="checkbox" id="item1" checked>
                            <label for="item1">Mathematics 101</label>
                        </div>
                        <div class="comparison-item">
                            <input type="checkbox" id="item2" checked>
                            <label for="item2">Science 202</label>
                        </div>
                        <div class="comparison-item">
                            <input type="checkbox" id="item3">
                            <label for="item3">English 101</label>
                        </div>
                        <div class="comparison-item">
                            <input type="checkbox" id="item4">
                            <label for="item4">History 101</label>
                        </div>
                        <div class="comparison-item">
                            <input type="checkbox" id="item5">
                            <label for="item5">Computer Science 202</label>
                        </div>
                    </div>
                </div>
                
                <button id="run-comparison" class="run-comparison-btn">Run Comparison</button>
            </div>
            
            <div class="chart-container full-width-chart">
                <div class="chart-header">
                    <div class="chart-title">Comparison Results</div>
                </div>
                <div class="chart-body"></div>
                    <canvas id="comparison-chart"></canvas>
                </div>
            </div>
            
            <div class="data-table-container">
                <div class="chart-header">
                    <div class="chart-title">Statistical Analysis</div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Average</th>
                            <th>Median</th>
                            <th>Std Dev</th>
                            <th>Min</th>
                            <th>Max</th>
                        </tr>
                    </thead>
                    <tbody id="stats-table">
                        <tr>
                            <td>Mathematics 101</td>
                            <td>85%</td>
                            <td>87%</td>
                            <td>6.2</td>
                            <td>70%</td>
                            <td>98%</td>
                        </tr>
                        <tr>
                            <td>Science 202</td>
                            <td>78%</td>
                            <td>80%</td>
                            <td>7.5</td>
                            <td>65%</td>
                            <td>95%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Add chart containers for analytics -->
        <div class="chart-container">
            <canvas id="attendance-rate-chart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="exam-score-chart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="comment-classification-chart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="homework-score-chart"></canvas>
        </div>
    </div>

    <!-- Load Analytics JS -->
    <script src="analytics.js"></script>
</body>
</html>